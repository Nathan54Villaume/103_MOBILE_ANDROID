<!DOCTYPE html>
<html lang="fr" class="h-full">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Administration Serveur ‚Äî API_AI_ATF</title>
  <!-- Tailwind CSS CDN - Pour d√©veloppement uniquement -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ["Inter", "ui-sans-serif", "system-ui"] },
          colors: {
            ink: { 900: "#0b0f14", 800: "#0f141b", 700: "#131924", 600: "#1a2332" },
            brand: { 400: "#34d399", 500: "#10b981", 600: "#059669" }
          },
          boxShadow: { glass: "0 10px 30px -12px rgba(0,0,0,.5)" }
        }
      }
    }
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <style>
    html, body { background: #0b0f14; min-height: 100vh; }
    .card { 
      backdrop-filter: blur(6px); 
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03)); 
      border: 1px solid rgba(255,255,255,0.08); 
    }
    .card-hover { transition: all 0.2s; }
    .card-hover:hover { background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.05)); }
    .status-dot { width: 8px; height: 8px; border-radius: 50%; }
    .status-dot.online { background: #10b981; box-shadow: 0 0 8px #10b981; }
    .status-dot.offline { background: #ef4444; box-shadow: 0 0 8px #ef4444; }
    .status-dot.warning { background: #f59e0b; box-shadow: 0 0 8px #f59e0b; }
    .sidebar { transition: transform 0.3s; }
    .sidebar.hidden-mobile { transform: translateX(-100%); }
    @media (min-width: 768px) { .sidebar.hidden-mobile { transform: translateX(0); } }
    .hide-scrollbar::-webkit-scrollbar { display: none; }
    .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    #loginScreen { backdrop-filter: blur(10px); }
    
    /* Styles pour les dropdowns/select */
    select {
      background: rgba(255,255,255,0.05) !important;
      border: 1px solid rgba(255,255,255,0.1) !important;
      color: #f1f5f9 !important;
    }
    select option {
      background: #1a2332 !important;
      color: #f1f5f9 !important;
    }
    
    /* Animation pour les cartes collapsibles */
    .collapsible-content {
      transition: all 0.3s ease-in-out;
      overflow: hidden;
    }
    .collapsible-content.collapsed {
      max-height: 0;
      opacity: 0;
      padding-top: 0;
      padding-bottom: 0;
    }
    .collapsible-content.expanded {
      max-height: 1000px;
      opacity: 1;
    }
    .collapsible-header {
      cursor: pointer;
      transition: all 0.2s;
    }
    .collapsible-header:hover {
      background: rgba(255,255,255,0.05);
    }
    
    /* Couleurs dynamiques pour les valeurs */
    .value-excellent { color: #10b981; } /* Vert - Excellent */
    .value-good { color: #34d399; } /* Vert clair - Bon */
    .value-warning { color: #f59e0b; } /* Orange - Attention */
    .value-danger { color: #ef4444; } /* Rouge - Danger */
    .value-critical { color: #dc2626; } /* Rouge fonc√© - Critique */
    
    /* DIRIS Tabs */
    .diris-tab-btn {
      color: #94a3b8;
    }
    .diris-tab-btn.active {
      background: rgba(16, 185, 129, 0.15);
      color: #10b981;
      font-weight: 600;
    }
    .diris-tab-content {
      display: none;
    }
    .diris-tab-content:not(.hidden) {
      display: block;
    }
    
    /* Configuration info icons and tooltips */
    .config-info-icon {
      cursor: help;
      opacity: 0.7;
      transition: opacity 0.2s ease;
      position: relative;
    }
    
    .config-info-icon:hover {
      opacity: 1;
    }
    
    .config-info-icon::after {
      content: attr(data-tooltip);
      position: absolute;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.95);
      color: white;
      padding: 12px 16px;
      border-radius: 8px;
      font-size: 13px;
      white-space: nowrap;
      max-width: 550px;
      min-width: 200px;
      white-space: normal;
      text-align: left;
      line-height: 1.5;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
      z-index: 1000;
      border: 1px solid rgba(255, 255, 255, 0.15);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
    }
    
    .config-info-icon:hover::after {
      opacity: 1;
      visibility: visible;
    }
    
    /* Enhanced tooltips for coherence section */
    [data-tooltip] {
      cursor: help;
      position: relative;
    }
    
    [data-tooltip]::after {
      content: attr(data-tooltip);
      position: absolute;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.95);
      color: white;
      padding: 12px 16px;
      border-radius: 8px;
      font-size: 13px;
      max-width: 550px;
      min-width: 200px;
      white-space: normal;
      text-align: left;
      line-height: 1.5;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.2s ease;
      z-index: 1000;
      border: 1px solid rgba(255, 255, 255, 0.15);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
      pointer-events: none;
    }
    
    [data-tooltip]:hover::after {
      opacity: 1;
      visibility: visible;
      transform: translateX(-50%) translateY(-2px);
    }
    
    /* Tooltip arrow */
    [data-tooltip]::before {
      content: '';
      position: absolute;
      bottom: 118%;
      left: 50%;
      transform: translateX(-50%);
      border: 6px solid transparent;
      border-top-color: rgba(0, 0, 0, 0.95);
      z-index: 1001;
      pointer-events: none;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }
    
    [data-tooltip]:hover::before {
      opacity: 1;
      visibility: visible;
    }
    
    /* Tooltips for buttons - display below instead of above */
    button[data-tooltip]::after {
      bottom: auto;
      top: 125%;
      transform: translateX(-50%);
    }
    
    button[data-tooltip]:hover::after {
      transform: translateX(-50%) translateY(2px);
    }
    
    button[data-tooltip]::before {
      bottom: auto;
      top: 118%;
      border-top-color: transparent;
      border-bottom-color: rgba(0, 0, 0, 0.95);
    }
    
    .config-info-icon::before {
      content: '';
      position: absolute;
      bottom: 115%;
      left: 50%;
      transform: translateX(-50%);
      border: 5px solid transparent;
      border-top-color: rgba(0, 0, 0, 0.9);
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }
    
    .config-info-icon:hover::before {
      opacity: 1;
      visibility: visible;
    }
  </style>
</head>
<body class="h-full text-slate-100 font-sans">
  
  <!-- √âcran de connexion -->
  <div id="loginScreen" class="fixed inset-0 z-50 bg-ink-900/95 flex items-center justify-center p-4">
    <div class="card rounded-2xl p-8 shadow-glass max-w-md w-full">
      <div class="text-center mb-6">
        <div class="h-16 w-16 mx-auto rounded-2xl bg-brand-500/20 grid place-items-center text-4xl mb-4">üîê</div>
        <h2 class="text-2xl font-bold">API_AI_ATF</h2>
        <p class="text-slate-400 text-sm mt-2">Authentification requise</p>
      </div>
      
      <form id="loginForm" class="space-y-4">
        <div>
          <label for="username" class="block text-sm text-slate-300 mb-2">Nom d'utilisateur</label>
          <input 
            type="text" 
            id="username" 
            name="username" 
            autocomplete="username"
            class="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-brand-500"
            required
          />
        </div>
        
        <div>
          <label for="password" class="block text-sm text-slate-300 mb-2">Mot de passe</label>
          <input 
            type="password" 
            id="password" 
            name="password" 
            autocomplete="current-password"
            class="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-brand-500"
            required
          />
        </div>
        
        <div id="loginError" class="hidden p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm"></div>
        
        <button 
          type="submit" 
          class="w-full px-4 py-3 bg-brand-500 hover:bg-brand-600 rounded-lg font-semibold transition-colors"
        >
          Se connecter
        </button>
      </form>
    </div>
  </div>

  <!-- Application principale -->
  <div id="app" class="hidden h-full flex">
    
    <!-- Sidebar -->
    <aside class="sidebar w-64 bg-ink-800 border-r border-white/10 flex flex-col">
      <div class="p-5 border-b border-white/10">
        <div class="flex items-center gap-3">
          <div class="h-10 w-10 rounded-xl bg-brand-500/20 grid place-items-center text-2xl">‚öôÔ∏è</div>
          <div class="flex-1">
            <h1 class="font-bold text-sm">Administration</h1>
            <p class="text-xs text-slate-400">API_AI_ATF</p>
          </div>
        </div>
      </div>
      
      <nav class="flex-1 p-4 space-y-1">
        <a href="#dashboard" class="nav-item active flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-white/10 transition-colors">
          <span>üìä</span>
          <span class="text-sm font-medium">Dashboard</span>
        </a>
        <a href="#server" class="nav-item flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-white/10 transition-colors">
          <span>üíª</span>
          <span class="text-sm font-medium">Serveur</span>
        </a>
        <a href="#system" class="nav-item flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-white/10 transition-colors">
          <span>üñ•Ô∏è</span>
          <span class="text-sm font-medium">Syst√®me</span>
        </a>
        <a href="#database" class="nav-item flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-white/10 transition-colors">
          <span>üíæ</span>
          <span class="text-sm font-medium">Bases de donn√©es</span>
        </a>
        <a href="#s7" class="nav-item flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-white/10 transition-colors">
          <span>üîå</span>
          <span class="text-sm font-medium">PLC S7</span>
        </a>
        <a href="#diris" class="nav-item flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-white/10 transition-colors">
          <span>‚ö°</span>
          <span class="text-sm font-medium">DIRIS</span>
        </a>
        <a href="#logs" class="nav-item flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-white/10 transition-colors">
          <span>üìù</span>
          <span class="text-sm font-medium">Logs</span>
        </a>
        <a href="#config" class="nav-item flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-white/10 transition-colors">
          <span>‚öôÔ∏è</span>
          <span class="text-sm font-medium">Configuration</span>
        </a>
        <a href="#api" class="nav-item flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-white/10 transition-colors">
          <span>üåê</span>
          <span class="text-sm font-medium">API</span>
        </a>
        <a href="#requests" class="nav-item flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-white/10 transition-colors">
          <span>üì°</span>
          <span class="text-sm font-medium">Requ√™tes</span>
        </a>
      </nav>
      
      <div class="p-4 border-t border-white/10">
        <div class="flex items-center gap-3 mb-3">
          <div class="h-8 w-8 rounded-full bg-brand-500/20 grid place-items-center text-sm">üë§</div>
          <div class="flex-1 min-w-0">
            <p id="userDisplay" class="text-sm font-medium truncate">admin</p>
            <p class="text-xs text-slate-400">Administrateur</p>
          </div>
        </div>
        <button id="btnLogout" class="w-full px-3 py-2 text-sm rounded-lg bg-white/5 hover:bg-white/10 border border-white/10 transition-colors">
          D√©connexion
        </button>
      </div>
    </aside>

    <!-- Main content -->
    <main class="flex-1 overflow-y-auto hide-scrollbar">
      
      <!-- Header -->
      <header class="sticky top-0 z-40 border-b border-white/10 bg-ink-900/80 backdrop-blur">
        <div class="px-6 py-4 flex items-center justify-between max-w-7xl mx-auto">
          <div class="flex-1">
            <h2 id="pageTitle" class="text-xl font-semibold">Dashboard</h2>
            <p id="pageSubtitle" class="text-sm text-slate-400">Vue d'ensemble du syst√®me</p>
          </div>
          <div class="flex items-center gap-3">
            <div class="flex items-center gap-2 px-3 py-2 rounded-lg bg-white/5 border border-white/10">
              <div id="globalStatusDot" class="status-dot online"></div>
              <span id="globalStatus" class="text-sm">En ligne</span>
            </div>
            <button id="btnRefresh" class="px-3 py-2 rounded-lg bg-white/10 hover:bg-white/20 border border-white/10 transition-colors">
              üîÑ
            </button>
          </div>
        </div>
      </header>

      <!-- Content -->
      <div class="p-6">
        <div class="max-w-7xl mx-auto">
        
        <!-- Dashboard Section -->
        <section id="section-dashboard" class="space-y-6">
          
          <!-- KPIs -->
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
            <div class="card rounded-xl p-4 shadow-glass">
              <div class="flex items-center justify-between mb-2">
                <p class="text-slate-400 text-xs">CPU</p>
                <span class="text-xl">üíª</span>
              </div>
              <p id="kpiCpu" class="text-2xl font-bold">‚Äî%</p>
              <p class="text-xs text-slate-500 mt-1">Utilisation processeur</p>
            </div>
            
            <div class="card rounded-xl p-4 shadow-glass">
              <div class="flex items-center justify-between mb-2">
                <p class="text-slate-400 text-xs">M√©moire</p>
                <span class="text-xl">üß†</span>
              </div>
              <p id="kpiMemory" class="text-2xl font-bold">‚Äî MB</p>
              <p class="text-xs text-slate-500 mt-1"><span id="kpiMemoryPercent">‚Äî</span>% utilis√©e</p>
            </div>
            
            <div class="card rounded-xl p-4 shadow-glass">
              <div class="flex items-center justify-between mb-2">
                <p class="text-slate-400 text-xs">Uptime</p>
                <span class="text-xl">‚è±Ô∏è</span>
              </div>
              <p id="kpiUptime" class="text-2xl font-bold">‚Äî</p>
              <p class="text-xs text-slate-500 mt-1">Temps de fonctionnement</p>
            </div>
            
            <div class="card rounded-xl p-4 shadow-glass">
              <div class="flex items-center justify-between mb-2">
                <p class="text-slate-400 text-xs">Connexions</p>
                <span class="text-xl">üîå</span>
              </div>
              <p id="kpiConnections" class="text-2xl font-bold">‚Äî</p>
              <p class="text-xs text-slate-500 mt-1">BDD + PLC</p>
            </div>
          </div>

          <!-- Charts -->
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
            <div class="card rounded-xl p-5 shadow-glass">
              <h3 class="font-semibold mb-4">M√©moire Serveur vs Machine</h3>
              <div style="height: 250px; max-height: 250px; position: relative;">
                <canvas id="chartMemoryUsage"></canvas>
              </div>
            </div>
            
            <div class="card rounded-xl p-5 shadow-glass">
              <h3 class="font-semibold mb-4">CPU Serveur vs Machine</h3>
              <div style="height: 250px; max-height: 250px; position: relative;">
                <canvas id="chartCpuUsage"></canvas>
              </div>
            </div>
          </div>

          <!-- Health Status -->
          <div class="card rounded-xl p-5 shadow-glass">
            <h3 class="font-semibold mb-4">√âtat des services</h3>
            <div id="servicesStatus" class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <!-- Dynamically populated -->
            </div>
          </div>

          <!-- Logs Chart moved below services -->
          <div class="card rounded-xl p-5 shadow-glass">
            <h3 class="font-semibold mb-4">Statistiques Logs</h3>
            <div style="height: 250px; max-height: 250px; position: relative;">
              <canvas id="chartLogs"></canvas>
            </div>
          </div>

        </section>

        <!-- Server Section (hidden by default) -->
        <section id="section-server" class="hidden space-y-6">
          <div class="card rounded-xl p-5 shadow-glass">
            <h3 class="font-semibold mb-4">Informations Serveur</h3>
            <div id="serverInfo" class="space-y-3">
              <!-- Dynamically populated -->
            </div>
          </div>
        </section>

        <!-- System Section (hidden by default) -->
        <section id="section-system" class="hidden space-y-6">
          <!-- Machine Metrics -->
          <div class="card rounded-xl p-5 shadow-glass">
            <h3 class="font-semibold mb-4">üñ•Ô∏è M√©triques Machine</h3>
            <div id="systemMetrics" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
              <!-- Dynamically populated -->
            </div>
          </div>

          <!-- Process Metrics -->
          <div class="card rounded-xl p-5 shadow-glass">
            <h3 class="font-semibold mb-4">‚öôÔ∏è M√©triques Processus</h3>
            <div id="processMetrics" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
              <!-- Dynamically populated -->
            </div>
          </div>

          <!-- System Charts -->
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
            <div class="card rounded-xl p-5 shadow-glass">
              <h3 class="font-semibold mb-4">CPU Syst√®me vs Processus</h3>
              <div style="height: 300px; max-height: 300px; position: relative;">
                <canvas id="chartSystemCpu"></canvas>
              </div>
            </div>
            <div class="card rounded-xl p-5 shadow-glass">
              <h3 class="font-semibold mb-4">M√©moire Syst√®me vs Processus</h3>
              <div style="height: 300px; max-height: 300px; position: relative;">
                <canvas id="chartSystemMemory"></canvas>
              </div>
            </div>
          </div>
        </section>

        <!-- Database Section (hidden by default) -->
        <section id="section-database" class="hidden space-y-6">
          <div id="databaseList" class="space-y-4">
            <!-- Dynamically populated -->
          </div>
        </section>

        <!-- S7 Section (hidden by default) -->
        <section id="section-s7" class="hidden space-y-6">
          
          <!-- Formulaire d'ajout -->
          <div class="card rounded-xl shadow-glass">
            <div class="collapsible-header p-5 pb-3 flex items-center justify-between" onclick="toggleCollapsible('addPlcCard')">
              <h3 class="font-semibold">‚ûï Ajouter un PLC</h3>
              <svg id="addPlcCardIcon" class="w-5 h-5 transform transition-transform duration-300" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path>
              </svg>
            </div>
            <div id="addPlcCard" class="collapsible-content collapsed px-5 pb-5">
              <form id="addPlcForm" class="space-y-4">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label for="plcName" class="block text-sm text-slate-300 mb-2">Nom *</label>
                  <input 
                    type="text" 
                    id="plcName" 
                    name="name"
                    placeholder="Nom du PLC"
                    class="w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-brand-500"
                    required
                  />
                </div>
                
                <div>
                  <label for="plcIp" class="block text-sm text-slate-300 mb-2">Adresse IP *</label>
                  <input 
                    type="text" 
                    id="plcIp" 
                    name="ipAddress"
                    placeholder="IP"
                    class="w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-brand-500"
                    required
                  />
                </div>
                
                <div>
                  <label for="plcRack" class="block text-sm text-slate-300 mb-2">Rack</label>
                  <input 
                    type="number" 
                    id="plcRack" 
                    name="rack"
                    value="0"
                    min="0"
                    max="7"
                    class="w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-brand-500"
                  />
                </div>
                
                <div>
                  <label for="plcSlot" class="block text-sm text-slate-300 mb-2">Slot</label>
                  <input 
                    type="number" 
                    id="plcSlot" 
                    name="slot"
                    value="1"
                    min="0"
                    max="31"
                    class="w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-brand-500"
                  />
                </div>
                
                <div>
                  <label for="plcPort" class="block text-sm text-slate-300 mb-2">Port</label>
                  <input 
                    type="number" 
                    id="plcPort" 
                    name="port"
                    value="102"
                    min="1"
                    max="65535"
                    class="w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-brand-500"
                  />
                </div>
                
                <div>
                  <label for="plcCpuType" class="block text-sm text-slate-300 mb-2">Type CPU</label>
                  <select 
                    id="plcCpuType" 
                    name="cpuType"
                    class="w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-brand-500"
                  >
                    <option value="S7-1500">S7-1500</option>
                    <option value="S7-1200">S7-1200</option>
                    <option value="S7-400">S7-400</option>
                    <option value="S7-300">S7-300</option>
                  </select>
                </div>
              </div>
              
                <div class="flex justify-end">
                  <button 
                    type="submit" 
                    class="px-6 py-2 bg-brand-500 hover:bg-brand-600 rounded-lg font-semibold transition-colors"
                  >
                    Ajouter
                  </button>
                </div>
              </form>
            </div>
          </div>

          <!-- Liste des connexions -->
          <div class="card rounded-xl p-5 shadow-glass">
            <h3 class="font-semibold mb-4">Connexions S7 </h3>
            <div id="plcConnectionsList" class="space-y-3">
              <!-- Dynamically populated -->
            </div>
          </div>
          
        </section>

        <!-- DIRIS Logs Section (hidden by default) -->
        <section id="section-logs" class="hidden space-y-6">
          <div class="card rounded-xl p-5 shadow-glass">
            <!-- Barre d'actions (sticky) -->
            <div class="sticky top-0 bg-slate-900/95 backdrop-blur-sm z-10 pb-4 mb-4 border-b border-white/10">
              <div class="flex items-center justify-between mb-3">
                <div class="flex items-center gap-3">
                  <h3 class="font-semibold">üìù Logs DIRIS - Acquisition & Syst√®me</h3>
                  <span id="dirisLogsCurrentFile" class="px-2 py-1 text-xs bg-blue-500/20 text-blue-400 rounded font-mono">-</span>
                  <span id="dirisLogCounter" class="px-2 py-1 text-xs bg-white/10 rounded">
                    <span id="dirisLogsDisplayedCount">0</span> / <span id="dirisLogsTotalCount">0</span>
                  </span>
                </div>
                
                <!-- Contr√¥les Play/Stop/Clear/Refresh -->
                <div class="flex gap-2">
                  <button id="dirisLogsPlayBtn" class="px-3 py-2 text-sm rounded-lg bg-green-500/20 hover:bg-green-500/30 border border-green-500/30 transition-colors flex items-center gap-2 focus:outline-none focus:ring-0">
                    ‚ñ∂Ô∏è Auto-refresh
                  </button>
                  <button id="dirisLogsStopBtn" class="hidden px-3 py-2 text-sm rounded-lg bg-yellow-500/20 hover:bg-yellow-500/30 border border-yellow-500/30 transition-colors flex items-center gap-2 focus:outline-none focus:ring-0">
                    ‚è∏Ô∏è Stop
                  </button>
                  <button id="dirisLogsClearBtn" class="px-3 py-2 text-sm rounded-lg bg-white/10 hover:bg-white/20 border border-white/10 transition-colors focus:outline-none focus:ring-0">
                    üóëÔ∏è Vider
                  </button>
                  <button id="dirisLogsRefreshBtn" class="px-3 py-2 text-sm rounded-lg bg-blue-500/20 hover:bg-blue-500/30 border border-blue-500/30 transition-colors focus:outline-none focus:ring-0">
                    üîÑ Actualiser
                  </button>
                </div>
              </div>
              
              <!-- Filtres -->
              <div class="flex gap-2 items-center flex-wrap">
                <button data-diris-log-filter="all" class="px-3 py-2 text-sm rounded-lg bg-blue-600 text-white transition-colors focus:outline-none focus:ring-0">
                  üìã Tous les logs
                </button>
                <button data-diris-log-filter="acquisition" class="px-3 py-2 text-sm rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600 transition-colors focus:outline-none focus:ring-0">
                  üîå Acquisition uniquement
                </button>
                <button data-diris-log-filter="errors" class="px-3 py-2 text-sm rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600 transition-colors focus:outline-none focus:ring-0">
                  üî¥ Erreurs uniquement
                </button>
                <select id="dirisLogsMaxLines" class="px-3 py-2 text-sm rounded-lg bg-slate-700 text-slate-300 border border-white/10 focus:outline-none focus:ring-0">
                  <option value="50">50 lignes</option>
                  <option value="100">100 lignes</option>
                  <option value="200" selected>200 lignes</option>
                  <option value="500">500 lignes</option>
                  <option value="1000">1000 lignes</option>
                </select>
              </div>
              
              <!-- Info persistance -->
              <div class="mt-3 p-3 bg-blue-500/10 border border-blue-500/30 rounded-lg text-sm text-blue-300">
                üíæ <strong>Logs persistants</strong> : Stock√©s dans <code class="px-1 py-0.5 bg-black/30 rounded font-mono text-xs">C:\API_ATF_MOBILE\DATA\logs</code> (conserv√©s entre red√©ploiements)
              </div>
            </div>
            
            <!-- Liste des logs -->
            <div id="dirisLogsContainer" class="space-y-1 max-h-[700px] overflow-y-auto hide-scrollbar">
              <!-- Dynamically populated -->
              <p class="text-center text-slate-400 py-8">Chargement...</p>
            </div>
          </div>
        </section>

        <!-- Config Section (hidden by default) -->
        <section id="section-config" class="hidden space-y-6">
          <div class="card rounded-xl p-5 shadow-glass">
            <h3 class="font-semibold mb-4">Configuration actuelle</h3>
            <div id="configInfo" class="space-y-3">
              <!-- Dynamically populated -->
            </div>
          </div>
        </section>

        <!-- DIRIS Section (hidden by default) -->
        <section id="section-diris" class="hidden space-y-6">
          
          <!-- Tabs Navigation DIRIS -->
          <div class="card rounded-xl p-1 shadow-glass">
            <div class="flex gap-1 overflow-x-auto hide-scrollbar">
              <button class="diris-tab-btn active flex-1 px-4 py-3 rounded-lg text-sm font-medium transition-colors hover:bg-white/10" data-diris-tab="overview">
                üìä Vue d'ensemble
              </button>
              <button class="diris-tab-btn flex-1 px-4 py-3 rounded-lg text-sm font-medium transition-colors hover:bg-white/10" data-diris-tab="devices">
                üîå Devices
              </button>
              <button class="diris-tab-btn flex-1 px-4 py-3 rounded-lg text-sm font-medium transition-colors hover:bg-white/10" data-diris-tab="coherence">
                üìà Coh√©rence
              </button>
              <button class="diris-tab-btn flex-1 px-4 py-3 rounded-lg text-sm font-medium transition-colors hover:bg-white/10" data-diris-tab="config">
                ‚öôÔ∏è Configuration
              </button>
              <button class="diris-tab-btn flex-1 px-4 py-3 rounded-lg text-sm font-medium transition-colors hover:bg-white/10" data-diris-tab="history">
                üìú Historique
              </button>
            </div>
          </div>

          <!-- TAB: Vue d'ensemble -->
          <div id="diris-tab-overview" class="diris-tab-content space-y-6">
          
          <!-- Statut global DIRIS -->
          <div class="card rounded-xl p-5 shadow-glass">
            <div class="flex items-center justify-between mb-4">
              <div>
                <h3 class="font-semibold">Statut DIRIS Global</h3>
                <p class="text-xs text-slate-400 mt-1">Vue d'ensemble du syst√®me DIRIS</p>
              </div>
              <div id="dirisGlobalStatus" class="flex items-center gap-2">
                <div id="dirisGlobalStatusDot" class="status-dot unknown"></div>
                <span id="dirisGlobalStatusText" class="text-sm font-medium">V√©rification...</span>
              </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
              <div class="p-3 bg-white/5 rounded-lg text-center">
                <p class="text-xs text-slate-400 mb-1">Services</p>
                <p id="dirisServicesStatus" class="text-lg font-bold text-green-400">‚úÖ Actifs</p>
              </div>
              <div class="p-3 bg-white/5 rounded-lg text-center">
                <p class="text-xs text-slate-400 mb-1">Devices</p>
                <p id="dirisDevicesCount" class="text-lg font-bold text-blue-400">0</p>
              </div>
              <div class="p-3 bg-white/5 rounded-lg text-center">
                <p class="text-xs text-slate-400 mb-1">Performance</p>
                <p id="dirisPerformanceStatus" class="text-lg font-bold text-yellow-400">‚ö° Bon</p>
              </div>
              <div class="p-3 bg-white/5 rounded-lg text-center">
                <p class="text-xs text-slate-400 mb-1">Alertes</p>
                <p id="dirisAlertsCount" class="text-lg font-bold text-orange-400">0</p>
              </div>
            </div>
          </div>
          
          <!-- Services DIRIS -->
          <div class="card rounded-xl p-5 shadow-glass">
            <div class="flex items-center justify-between mb-4">
              <div>
                <h3 class="font-semibold">Services DIRIS</h3>
                <p class="text-xs text-slate-400 mt-1">Gestion des services d'acquisition</p>
              </div>
              <div class="flex items-center gap-3">
                <div class="flex items-center gap-2">
                  <input type="checkbox" id="dirisAutoRefresh" class="w-4 h-4 rounded bg-white/5 border-white/10" checked>
                  <label for="dirisAutoRefresh" class="text-xs text-slate-400">Auto-refresh</label>
                </div>
                <button id="btnRefreshDiris" class="px-3 py-2 text-sm rounded-lg bg-white/10 hover:bg-white/20 border border-white/10 transition-colors">
                  üîÑ Actualiser
                </button>
              </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <!-- Acquisition Service -->
              <div class="p-4 bg-white/5 rounded-lg border border-white/10">
                <div class="flex items-center justify-between mb-3">
                  <h4 class="font-medium">Service d'Acquisition</h4>
                  <div id="dirisAcqStatusDot" class="status-dot unknown"></div>
                </div>
                <p id="dirisAcqStatus" class="text-sm text-slate-400 mb-3">Chargement...</p>
                <div class="flex gap-2">
                  <button id="btnStartAcquisition" class="flex-1 px-3 py-2 text-sm rounded-lg bg-green-500/20 hover:bg-green-500/30 text-green-400 border border-green-500/30 transition-colors">
                    ‚ñ∂Ô∏è D√©marrer
                  </button>
                  <button id="btnStopAcquisition" class="flex-1 px-3 py-2 text-sm rounded-lg bg-red-500/20 hover:bg-red-500/30 text-red-400 border border-red-500/30 transition-colors">
                    ‚è∏Ô∏è Arr√™ter
                  </button>
                </div>
              </div>
              
              <!-- Data Retention Service -->
              <div class="p-4 bg-white/5 rounded-lg border border-white/10">
                <div class="flex items-center justify-between mb-3">
                  <h4 class="font-medium">Service de R√©tention</h4>
                  <div id="dirisRetStatusDot" class="status-dot unknown"></div>
                </div>
                <p id="dirisRetStatus" class="text-sm text-slate-400 mb-3">Chargement...</p>
                <button id="btnTriggerCleanup" class="w-full px-3 py-2 text-sm rounded-lg bg-orange-500/20 hover:bg-orange-500/30 text-orange-400 border border-orange-500/30 transition-colors">
                  üßπ Nettoyage manuel
                </button>
              </div>
            </div>
          </div>

          <!-- M√©triques d'acquisition en temps r√©el -->
          <div class="card rounded-xl p-5 shadow-glass">
            <h3 class="font-semibold mb-4">M√©triques d'acquisition</h3>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
              <div class="p-3 bg-white/5 rounded-lg">
                <p class="text-xs text-slate-400">Points/seconde</p>
                <p id="dirisPointsPerSec" class="text-2xl font-bold text-brand-400">0</p>
              </div>
              <div class="p-3 bg-white/5 rounded-lg">
                <p class="text-xs text-slate-400">Devices/seconde</p>
                <p id="dirisDevicesPerSec" class="text-2xl font-bold text-blue-400">0</p>
              </div>
              <div class="p-3 bg-white/5 rounded-lg">
                <p class="text-xs text-slate-400">Latence P95</p>
                <p id="dirisP95Latency" class="text-2xl font-bold text-purple-400">0ms</p>
              </div>
              <div class="p-3 bg-white/5 rounded-lg">
                <p class="text-xs text-slate-400">Devices actifs</p>
                <p id="dirisActiveDevices" class="text-2xl font-bold text-green-400">0</p>
              </div>
            </div>
          </div>

          <!-- Statistiques de base de donn√©es -->
          <div class="card rounded-xl p-5 shadow-glass">
            <h3 class="font-semibold mb-4">Base de donn√©es DIRIS</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
              <div class="p-4 bg-white/5 rounded-lg">
                <p class="text-xs text-slate-400 mb-1">Total mesures</p>
                <p id="dirisTotalMeasurements" class="text-2xl font-bold">0</p>
                <p class="text-xs text-slate-400 mt-1">Dans DIRIS.Measurements</p>
              </div>
              <div class="p-4 bg-white/5 rounded-lg">
                <p class="text-xs text-slate-400 mb-1">√Ä supprimer</p>
                <p id="dirisMeasurementsToDelete" class="text-2xl font-bold text-orange-400">0</p>
                <p class="text-xs text-slate-400 mt-1">Anciennet√© > r√©tention</p>
              </div>
              <div class="p-4 bg-white/5 rounded-lg">
                <p class="text-xs text-slate-400 mb-1">Table [AI_ATR].[DIRIS].[Measurements]</p>
                <p id="dirisDatabaseSize" class="text-2xl font-bold text-blue-400">0 MB / 1 GB</p>
                <p class="text-xs text-slate-400 mt-1">
                  <span id="dirisDatabasePercentage">0%</span> utilis√©
                </p>
              </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div class="p-3 bg-white/5 rounded-lg">
                <p class="text-sm text-slate-400">Mesure la plus ancienne</p>
                <p id="dirisOldestMeasurement" class="font-mono text-xs mt-1">-</p>
              </div>
              <div class="p-3 bg-white/5 rounded-lg">
                <p class="text-sm text-slate-400">Mesure la plus r√©cente</p>
                <p id="dirisNewestMeasurement" class="font-mono text-xs mt-1">-</p>
              </div>
            </div>
          </div>

          <!-- Graphiques temps r√©el -->
          <div class="card rounded-xl p-5 shadow-glass">
            <div class="flex items-center justify-between mb-4">
              <h3 class="font-semibold">Graphiques temps r√©el</h3>
              <div class="flex gap-2">
                <button id="btnPauseCharts" class="px-3 py-2 text-sm rounded-lg bg-white/10 hover:bg-white/20 border border-white/10 transition-colors">
                  ‚è∏Ô∏è Pause
                </button>
                <button id="btnResetCharts" class="px-3 py-2 text-sm rounded-lg bg-white/10 hover:bg-white/20 border border-white/10 transition-colors">
                  üîÑ Reset
                </button>
              </div>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
              <div class="p-4 bg-white/5 rounded-lg">
                <h4 class="text-sm font-medium mb-3">Throughput (Points/seconde)</h4>
                <div style="height: 200px; position: relative;">
                  <canvas id="dirisThroughputChart"></canvas>
                </div>
              </div>
              <div class="p-4 bg-white/5 rounded-lg">
                <h4 class="text-sm font-medium mb-3">Latence (ms)</h4>
                <div style="height: 200px; position: relative;">
                  <canvas id="dirisLatencyChart"></canvas>
                </div>
              </div>
            </div>
            <div class="mt-4 p-4 bg-white/5 rounded-lg">
              <h4 class="text-sm font-medium mb-3">Devices Actifs</h4>
              <div style="height: 150px; position: relative;">
                <canvas id="dirisDevicesChart"></canvas>
              </div>
            </div>
          </div>

          <!-- Syst√®me d'alertes -->
          <div class="card rounded-xl p-5 shadow-glass">
            <div class="flex items-center justify-between mb-4">
              <div>
                <h3 class="font-semibold">Syst√®me d'alertes</h3>
                <p class="text-xs text-slate-400 mt-1">Configuration des seuils de performance</p>
              </div>
              <div class="flex items-center gap-2">
                <input type="checkbox" id="dirisAlertsEnabled" class="w-4 h-4 rounded bg-white/5 border-white/10" checked>
                <label for="dirisAlertsEnabled" class="text-xs text-slate-400">Alertes actives</label>
              </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
              <div class="space-y-3">
                <h4 class="text-sm font-medium">Seuils d'alerte</h4>
                <div>
                  <label class="block text-xs text-slate-400 mb-1 flex items-center gap-2">
                    Latence max (ms)
                    <span class="config-info-icon" data-tooltip="Seuil maximum de latence avant d√©clenchement d'une alerte. Recommand√©: 1000-5000ms">‚ÑπÔ∏è</span>
                  </label>
                  <input type="number" id="alertMaxLatency" class="w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-sm" value="2000" min="100" max="10000">
                </div>
                <div>
                  <label class="block text-xs text-slate-400 mb-1 flex items-center gap-2">
                    Throughput min (pts/s)
                    <span class="config-info-icon" data-tooltip="Seuil minimum de throughput avant d√©clenchement d'une alerte. Recommand√©: 1-10 pts/s">‚ÑπÔ∏è</span>
                  </label>
                  <input type="number" id="alertMinThroughput" class="w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-sm" value="1" min="0" max="100">
                </div>
                <div>
                  <label class="block text-xs text-slate-400 mb-1 flex items-center gap-2">
                    Devices actifs min
                    <span class="config-info-icon" data-tooltip="Nombre minimum de devices actifs avant d√©clenchement d'une alerte">‚ÑπÔ∏è</span>
                  </label>
                  <input type="number" id="alertMinDevices" class="w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-sm" value="1" min="0" max="50">
                </div>
              </div>
              
              <div>
                <div class="flex items-center justify-between mb-3">
                  <h4 class="text-sm font-medium">Alertes r√©centes</h4>
                  <button id="btnClearAlerts" class="px-3 py-1 text-xs rounded-lg bg-white/10 hover:bg-white/20 border border-white/10 transition-colors">
                    üóëÔ∏è Vider
                  </button>
                </div>
                <div id="dirisAlertsList" class="space-y-2 max-h-48 overflow-y-auto hide-scrollbar">
                  <p class="text-center text-slate-400 py-4">Aucune alerte r√©cente</p>
                </div>
              </div>
            </div>
          </div>
          
          </div>
          <!-- FIN TAB: Vue d'ensemble -->

          <!-- TAB: Coh√©rence -->
          <div id="diris-tab-coherence" class="diris-tab-content space-y-6 hidden">

          <!-- Statistiques de coh√©rence en temps r√©el -->
          <div class="card rounded-xl p-5 shadow-glass">
            <div class="flex items-center justify-between mb-4">
              <div>
                <h3 class="font-semibold">üìä Coh√©rence de l'acquisition</h3>
                <p class="text-xs text-slate-400 mt-1">Statistiques en temps r√©el pour v√©rifier la stabilit√©</p>
              </div>
              <div class="flex gap-2">
                <button id="btnResetCoherence" class="px-3 py-2 text-sm rounded-lg bg-red-500/20 hover:bg-red-500/30 text-red-400 border border-red-500/30 transition-colors" data-tooltip="R√©initialise le calcul de coh√©rence depuis maintenant. Ignore l'historique pr√©c√©dent et repart sur de nouvelles bases pour un score plus pr√©cis.">
                  üîÑ R√©initialiser
                </button>
                <button id="btnClearCoherenceData" class="px-3 py-2 text-sm rounded-lg bg-orange-500/20 hover:bg-orange-500/30 text-orange-400 border border-orange-500/30 transition-colors" data-tooltip="Supprime les anciennes donn√©es de la base (garde les 5 derni√®res minutes). Utile pour nettoyer et repartir sur des donn√©es r√©centes.">
                  üóëÔ∏è Vider donn√©es
                </button>
                <button id="btnRefreshCoherence" class="px-3 py-2 text-sm rounded-lg bg-white/10 hover:bg-white/20 border border-white/10 transition-colors" data-tooltip="Actualise les statistiques de coh√©rence en temps r√©el. Recalcule les KPIs et le score global.">
                  üîÑ Actualiser
                </button>
              </div>
            </div>
            
            <!-- M√©triques principales -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
              <div class="p-3 bg-white/5 rounded-lg">
                <p class="text-xs text-slate-400 flex items-center gap-1">
                  Qualit√© donn√©es
                  <span class="config-info-icon" data-tooltip="Pourcentage de mesures avec une qualit√© parfaite (Quality = 1). Un score de 100% indique que toutes les mesures sont fiables et sans erreur.">‚ÑπÔ∏è</span>
                </p>
                <p id="coherenceQuality" class="text-2xl font-bold value-excellent">100%</p>
                <p class="text-xs text-slate-500 mt-1">Quality = 1</p>
              </div>
              <div class="p-3 bg-white/5 rounded-lg">
                <p class="text-xs text-slate-400 flex items-center gap-1">
                  Fr√©quence acquisition
                  <span class="config-info-icon" data-tooltip="Intervalle moyen entre deux mesures cons√©cutives. Une fr√©quence stable (1-3s) indique une acquisition r√©guli√®re et performante.">‚ÑπÔ∏è</span>
                </p>
                <p id="coherenceFrequency" class="text-2xl font-bold value-good">~1.7s</p>
                <p class="text-xs text-slate-500 mt-1">Secondes</p>
              </div>
              <div class="p-3 bg-white/5 rounded-lg">
                <p class="text-xs text-slate-400 flex items-center gap-1">
                  R√©gularit√©
                  <span class="config-info-icon" data-tooltip="√âcart-type des intervalles de mesure. Plus la valeur est faible (¬±50ms), plus l'acquisition est r√©guli√®re et stable.">‚ÑπÔ∏è</span>
                </p>
                <p id="coherenceRegularity" class="text-2xl font-bold value-excellent">¬±50ms</p>
                <p class="text-xs text-slate-500 mt-1">√âcart-type</p>
              </div>
              <div class="p-3 bg-white/5 rounded-lg">
                <p class="text-xs text-slate-400 flex items-center gap-1">
                  Score coh√©rence
                  <span class="config-info-icon" data-tooltip="Score global de coh√©rence (0-100). Combine qualit√©, r√©gularit√© et absence de gaps. 90-100: Excellent, 75-89: Bon, 50-74: Moyen, 0-49: Faible.">‚ÑπÔ∏è</span>
                </p>
                <p id="coherenceScore" class="text-2xl font-bold value-excellent">95/100</p>
                <p class="text-xs text-slate-500 mt-1">Global</p>
              </div>
            </div>
            
            <!-- Statistiques par device -->
            <div class="mb-4">
              <h4 class="text-sm font-medium mb-3 flex items-center gap-2">
                Statistiques par Device (derni√®re heure)
                <span class="config-info-icon" data-tooltip="D√©tails par √©quipement: nombre de mesures, fr√©quence moyenne, et stabilit√©. Permet d'identifier les devices probl√©matiques.">‚ÑπÔ∏è</span>
              </h4>
              <div id="coherenceDeviceStats" class="space-y-2">
                <p class="text-center text-slate-400 py-4">Chargement...</p>
              </div>
            </div>
            
            <!-- Trous d√©tect√©s -->
            <div>
              <div class="flex items-center justify-between mb-3">
                <h4 class="text-sm font-medium flex items-center gap-2">
                  Interruptions d√©tect√©es (30 derni√®res minutes)
                  <span class="config-info-icon" data-tooltip="Liste des interruptions d'acquisition d√©tect√©es. Une interruption > 30s indique un probl√®me de communication ou de r√©seau.">‚ÑπÔ∏è</span>
                </h4>
                <button id="btnClearGaps" class="px-3 py-1 text-xs rounded-lg bg-white/10 hover:bg-white/20 border border-white/10 transition-colors" data-tooltip="Efface l'affichage des interruptions. Ne supprime pas les donn√©es de la base, seulement l'affichage.">
                  üóëÔ∏è Vider l'affichage
                </button>
              </div>
              <div id="coherenceGaps" class="space-y-2 max-h-96 overflow-y-auto hide-scrollbar">
                <p class="text-center text-slate-400 py-4">Analyse en cours...</p>
              </div>
            </div>
          </div>
          
          </div>
          <!-- FIN TAB: Coh√©rence -->

          <!-- TAB: Configuration -->
          <div id="diris-tab-config" class="diris-tab-content space-y-6 hidden">

          <!-- Configuration -->
          <div class="card rounded-xl p-5 shadow-glass">
            <div class="flex items-center justify-between mb-4">
              <div>
                <h3 class="font-semibold">Configuration DIRIS</h3>
                <p class="text-xs text-slate-400 mt-1">Param√®tres d'acquisition et r√©tention</p>
              </div>
              <div class="flex gap-2">
                <button id="btnResetDirisConfig" class="px-3 py-2 text-sm rounded-lg bg-white/10 hover:bg-white/20 border border-white/10 transition-colors">
                  üîÑ Reset
                </button>
                <button id="btnSaveDirisConfig" class="px-4 py-2 text-sm rounded-lg bg-brand-500 hover:bg-brand-600 transition-colors">
                  üíæ Sauvegarder
                </button>
              </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <!-- Acquisition Settings -->
              <div>
                <h4 class="font-medium mb-3 text-sm">Acquisition</h4>
                <div class="space-y-3">
                  <div>
                    <label class="block text-xs text-slate-400 mb-1 flex items-center gap-2">
                      Devices simultan√©s
                      <span class="config-info-icon" data-tooltip="Nombre de devices interrog√©s simultan√©ment. Plus √©lev√© = plus rapide mais plus de charge r√©seau. Recommand√©: 4-8">‚ÑπÔ∏è</span>
                    </label>
                    <input type="number" id="configParallelism" min="1" max="20" class="w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-sm" value="6">
                  </div>
                  <div>
                    <label class="block text-xs text-slate-400 mb-1 flex items-center gap-2">
                      Fr√©quence d'acquisition (ms)
                      <span class="config-info-icon" data-tooltip="Fr√©quence d'interrogation des devices. Plus bas = plus r√©actif mais plus de charge. Recommand√©: 1000-3000ms">‚ÑπÔ∏è</span>
                    </label>
                    <input type="number" id="configPollInterval" min="500" max="10000" step="100" class="w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-sm" value="1500">
                  </div>
                  <div>
                    <label class="block text-xs text-slate-400 mb-1 flex items-center gap-2">
                      Taille max des lots
                      <span class="config-info-icon" data-tooltip="Nombre maximum de mesures trait√©es par lot en base. Plus √©lev√© = plus efficace mais plus de m√©moire. Recommand√©: 500-2000">‚ÑπÔ∏è</span>
                    </label>
                    <input type="number" id="configMaxBatch" min="100" max="5000" step="100" class="w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-sm" value="1000">
                  </div>
                </div>
              </div>
              
              <!-- Retention Settings -->
              <div>
                <h4 class="font-medium mb-3 text-sm">R√©tention des donn√©es</h4>
                <div class="space-y-3">
                  <div>
                    <label class="block text-xs text-slate-400 mb-1 flex items-center gap-2">
                      Dur√©e (jours)
                      <span class="config-info-icon" data-tooltip="Nombre de jours de conservation des donn√©es. Les mesures plus anciennes seront supprim√©es. Recommand√©: 7-30 jours selon l'usage">‚ÑπÔ∏è</span>
                    </label>
                    <input type="number" id="configRetentionDays" min="1" max="365" class="w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-sm" value="10">
                  </div>
                  <div>
                    <label class="block text-xs text-slate-400 mb-1 flex items-center gap-2">
                      Heure de nettoyage
                      <span class="config-info-icon" data-tooltip="Heure quotidienne (format 24h) pour le nettoyage automatique. Choisir une heure de faible activit√©. Recommand√©: 2-4h du matin">‚ÑπÔ∏è</span>
                    </label>
                    <input type="number" id="configCleanupHour" min="0" max="23" class="w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-sm" value="2">
                    <p class="text-xs text-slate-500 mt-1">Format 24h (0-23)</p>
                  </div>
                  <div>
                    <label class="block text-xs text-slate-400 mb-1 flex items-center gap-2">
                      Table [AI_ATR].[DIRIS].[Measurements] (MB)
                      <span class="config-info-icon" data-tooltip="Taille maximale allou√©e √† la table [AI_ATR].[DIRIS].[Measurements]. Recommand√©: 1024 MB (1 GB). Min: 100 MB, Max: 10240 MB (10 GB)">‚ÑπÔ∏è</span>
                    </label>
                    <input type="number" id="configMaxDatabaseSize" min="100" max="10240" step="128" class="w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-sm" value="1024">
                    <p class="text-xs text-slate-500 mt-1">1024 MB = 1 GB</p>
                  </div>
                  <div class="flex items-center gap-2">
                    <input type="checkbox" id="configRetentionEnabled" class="w-4 h-4 rounded bg-white/5 border-white/10">
                    <label for="configRetentionEnabled" class="text-xs text-slate-400 flex items-center gap-2">
                      Activer le nettoyage automatique
                      <span class="config-info-icon" data-tooltip="Active le nettoyage automatique quotidien des donn√©es anciennes. D√©sactiver seulement pour maintenance manuelle">‚ÑπÔ∏è</span>
                    </label>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          </div>
          <!-- FIN TAB: Configuration -->

          <!-- TAB: Devices -->
          <div id="diris-tab-devices" class="diris-tab-content space-y-6 hidden">

          <!-- Devices DIRIS -->
          <div class="card rounded-xl p-5 shadow-glass">
            <div class="flex items-center justify-between mb-4">
              <div>
                <h3 class="font-semibold">Devices DIRIS</h3>
                <p class="text-xs text-slate-400 mt-1">Liste des √©quipements configur√©s</p>
              </div>
              <button id="btnAddDevice" class="px-3 py-2 text-sm rounded-lg bg-brand-500 hover:bg-brand-600 transition-colors">
                ‚ûï Ajouter
              </button>
            </div>
            <div id="dirisDevicesList" class="space-y-2">
              <!-- Dynamically populated -->
              <p class="text-center text-slate-400 py-8">Chargement des devices...</p>
            </div>
          </div>
          
          </div>
          <!-- FIN TAB: Devices -->

          <!-- TAB: Historique -->
          <div id="diris-tab-history" class="diris-tab-content space-y-6 hidden">

          <!-- Derni√®res mesures -->
          <div class="card rounded-xl p-5 shadow-glass">
            <div class="flex items-center justify-between mb-4">
              <h3 class="font-semibold">Derni√®res mesures</h3>
              <div class="flex gap-2">
                <button onclick="window.dirisManager.exportData('csv')" class="px-3 py-2 text-sm rounded-lg bg-white/10 hover:bg-white/20 border border-white/10 transition-colors">
                  üìä Export CSV
                </button>
                <button onclick="window.dirisManager.exportData('json')" class="px-3 py-2 text-sm rounded-lg bg-white/10 hover:bg-white/20 border border-white/10 transition-colors">
                  üìÑ Export JSON
                </button>
              </div>
            </div>
            <div id="dirisLatestReadings" class="space-y-3 max-h-[400px] overflow-y-auto hide-scrollbar">
              <!-- Dynamically populated -->
              <p class="text-center text-slate-400 py-8">Chargement des mesures...</p>
            </div>
          </div>

          <!-- Historique des actions -->
          <div class="card rounded-xl p-5 shadow-glass">
            <div class="flex items-center justify-between mb-4">
              <div>
                <h3 class="font-semibold">Historique des actions</h3>
                <p class="text-xs text-slate-400 mt-1">Journal des √©v√©nements DIRIS</p>
              </div>
              <div class="flex gap-2">
                <button onclick="window.dirisManager.clearHistory()" class="px-3 py-2 text-sm rounded-lg bg-white/10 hover:bg-white/20 border border-white/10 transition-colors">
                  üóëÔ∏è Vider
                </button>
                <button onclick="window.dirisManager.exportHistory()" class="px-3 py-2 text-sm rounded-lg bg-white/10 hover:bg-white/20 border border-white/10 transition-colors">
                  üìÑ Export
                </button>
              </div>
            </div>
            <div id="dirisHistoryList" class="space-y-2 max-h-64 overflow-y-auto hide-scrollbar">
              <p class="text-center text-slate-400 py-8">Aucun √©v√©nement enregistr√©</p>
            </div>
          </div>
          
          </div>
          <!-- FIN TAB: Historique -->

        </section>

        <!-- API Section (hidden by default) -->
        <section id="section-api" class="hidden space-y-6">
          <div class="card rounded-xl p-5 shadow-glass">
            <h3 class="font-semibold mb-4">Contr√¥leurs API</h3>
            <div id="controllersList" class="space-y-3">
              <!-- Dynamically populated -->
            </div>
          </div>
        </section>

        <!-- Requ√™tes Section (hidden by default) -->
        <section id="section-requests" class="hidden space-y-6">
          <div class="card rounded-xl p-5 shadow-glass">
            <div class="flex items-center justify-between mb-4">
              <div>
                <h3 class="font-semibold">Requ√™tes API</h3>
                <p class="text-xs text-slate-400 mt-1">Historique des 100 derni√®res requ√™tes</p>
              </div>
              <div class="flex gap-2">
                <button id="btnClearRequests" class="px-3 py-2 text-sm rounded-lg bg-white/10 hover:bg-white/20 border border-white/10 transition-colors">
                  Vider
                </button>
                <button id="btnExportRequests" class="px-3 py-2 text-sm rounded-lg bg-white/10 hover:bg-white/20 border border-white/10 transition-colors">
                  Exporter CSV
                </button>
              </div>
            </div>
            
            <!-- Stats -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
              <div class="p-3 bg-white/5 rounded-lg">
                <p class="text-xs text-slate-400">Total</p>
                <p id="reqStatsTotal" class="text-2xl font-bold">0</p>
              </div>
              <div class="p-3 bg-green-500/10 rounded-lg">
                <p class="text-xs text-green-400">R√©ussies</p>
                <p id="reqStatsSuccess" class="text-2xl font-bold text-green-400">0</p>
              </div>
              <div class="p-3 bg-red-500/10 rounded-lg">
                <p class="text-xs text-red-400">√âchou√©es</p>
                <p id="reqStatsError" class="text-2xl font-bold text-red-400">0</p>
              </div>
              <div class="p-3 bg-blue-500/10 rounded-lg">
                <p class="text-xs text-blue-400">Temps moyen</p>
                <p id="reqStatsAvgTime" class="text-2xl font-bold text-blue-400">0ms</p>
              </div>
            </div>

            <!-- Liste des requ√™tes -->
            <div id="requestsList" class="space-y-2 max-h-[600px] overflow-y-auto hide-scrollbar">
              <p class="text-center text-slate-400 py-8">Aucune requ√™te enregistr√©e</p>
            </div>
          </div>
        </section>

        </div>
      </div>
    </main>
  </div>

  <!-- Scripts -->
  <script>
    // Fonction pour g√©rer les cartes collapsibles
    function toggleCollapsible(cardId) {
      const content = document.getElementById(cardId);
      const icon = document.getElementById(cardId + 'Icon');
      
      if (content.classList.contains('collapsed')) {
        content.classList.remove('collapsed');
        content.classList.add('expanded');
        icon.style.transform = 'rotate(180deg)';
      } else {
        content.classList.remove('expanded');
        content.classList.add('collapsed');
        icon.style.transform = 'rotate(0deg)';
      }
    }
    
    // Fonction pour g√©rer les sous-onglets DIRIS
    function initDirisTabs() {
      const tabButtons = document.querySelectorAll('.diris-tab-btn');
      const tabContents = document.querySelectorAll('.diris-tab-content');
      
      tabButtons.forEach(button => {
        button.addEventListener('click', () => {
          const tabName = button.getAttribute('data-diris-tab');
          
          // D√©sactiver tous les boutons et cacher tous les contenus
          tabButtons.forEach(btn => btn.classList.remove('active'));
          tabContents.forEach(content => content.classList.add('hidden'));
          
          // Activer le bouton et afficher le contenu s√©lectionn√©
          button.classList.add('active');
          const targetTab = document.getElementById(`diris-tab-${tabName}`);
          if (targetTab) {
            targetTab.classList.remove('hidden');
          }
          
          console.log(`üéØ DIRIS Tab switched to: ${tabName}`);
        });
      });
      
      console.log('‚úÖ DIRIS Tabs initialized');
    }
    
    // Initialiser les tabs DIRIS au chargement
    document.addEventListener('DOMContentLoaded', () => {
      initDirisTabs();
    });
  </script>
  <script type="module" src="js/admin.js?v=20251003-1020"></script>
</body>
</html>


